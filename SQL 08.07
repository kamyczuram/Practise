Find wineries producing wines with aromas of plum, cherry, rose, or hazelnut (singular form only). Substring matches, like cherries should be excluded.

SELECT winery DISTICNT FROM (
select winery, description 
from winemag_p1 
WHERE description LIKE '%plum%'
    OR description LIKE '%cherry%'
    OR description LIKE '%rose%'
    OR description LIKE '%hazelnut%')


Calculate each user's average session time, where a session is defined as the time difference between a page_load and a page_exit.
Assume each user has only one session per day. If there are multiple page_load or page_exit events on the same day, use only the 
latest page_load and the earliest page_exit, ensuring the page_load occurs before the page_exit. 
Output the user_id and their average session time.

WITH log_load_exit AS(
SELECT * 
FROM facebook_web_log
WHERE action IN ('page_load', 'page_exit')),

temp AS(
SELECT user_id, DATE(timestamp), MIN(timestamp), MAX(timestamp), action
FROM log_load_exit 
GROUP BY (DATE(timestamp), action, user_id))

SELECT user_id, AVG(time) AS avg_session_duration FROM (
SELECT user_id, date, MAX(min) - MIN(max) AS time 
FROM temp 
GROUP BY date, user_id
)
GROUP BY user_id



